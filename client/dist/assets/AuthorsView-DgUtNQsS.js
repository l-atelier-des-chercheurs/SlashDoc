import{n as o,_,A as u}from"../build.js";import{D as d}from"./DynamicTitle-CpTdDlYg.js";import{P as c}from"./PinnedNonpinnedFolder-BYibMEjl.js";const p={props:{has_sidebar:{type:Boolean,default:!0}},data(){return{show_sidebar:!1}}};var f=function(){var t=this,e=t._self._c;return e("section",{staticClass:"_filterableListLayout"},[e("div",{staticClass:"_filterSortBar"},[e("div",{staticClass:"_filterSortBar--leftSide"},[t._t("before-sidebar-toggle"),t.has_sidebar?e("div",{},[e("button",{staticClass:"u-button u-button_small u-button_bleumarine",class:{"is--active":t.show_sidebar},attrs:{type:"button",size:"small"},domProps:{textContent:t._s(t.show_sidebar?t.$t("hide"):t.$t("filter"))},on:{click:function(r){t.show_sidebar=!t.show_sidebar}}})]):t._e(),t._t("search"),t._t("top-left")],2),e("div",{staticClass:"_filterSortBar--rightSide"},[t._t("top-right")],2)]),e("div",{staticClass:"_cont"},[t.show_sidebar&&t.has_sidebar?e("div",{staticClass:"_sidebar"},[t._t("sidebar")],2):t._e(),e("div",{staticClass:"_listContent"},[t._t("active-filters"),t._t("list")],2)])])},h=[],m=o(p,f,h,!1,null,"471f68dc");const v=m.exports,y={props:{folders:Array,pinned_folders:{type:Array,default:()=>[]},path:String,can_edit:Boolean,pin_field_name:{type:String,default:"projects_pinned"},pin_label:{type:String,default:"Pinned"},empty_message:String,view_mode:{type:String,default:"list"}},components:{PinnedNonpinnedFolder:c}};var g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_foldersList"},[t.folders.length===0?e("div",{key:"nofolders",staticClass:"u-instructions _noFolders"},[t._v(" "+t._s(t.empty_message||t.$t("no_projects"))+" ")]):[e("PinnedNonpinnedFolder",{attrs:{field_name:t.pin_field_name,label:t.pin_label,content:t.pinned_folders,path:t.path,folders:t.folders,can_edit:t.can_edit,direction:["medium","tiny"].includes(t.view_mode)?"grid":"list",view_mode:t.view_mode},scopedSlots:t._u([{key:"default",fn:function(r){return[t._t("default",null,{item:r.item})]}}],null,!0)})]],2)},b=[],$=o(y,g,b,!1,null,"bc8b7381");const w=$.exports,k={props:{folders:Array,pinned_folders:Array,path:String,can_edit:Boolean,folder_type:{type:String,default:"project"},pin_field_name:String,pin_label:String,empty_message:String,display_original_space:Boolean,available_view_modes:{type:Array,default:()=>["list","medium","map","tiny"]}},components:{FilterableListLayout:v,FoldersList:w,DisplayOnMap:()=>_(()=>import("./DisplayOnMap-CwJWRqz3.js"),[])},data(){return{search_query:"",order_key:"$date_created",current_view_mode:"medium",filter_by_group:""}},created(){this.current_view_mode=localStorage.getItem(this.view_mode_saved_key)||"medium"},watch:{current_view_mode(s){s&&localStorage.setItem(this.view_mode_saved_key,s)},folder_type:{immediate:!0,handler(){this.folder_type==="author"&&(this.order_key="alphabetical")}}},computed:{view_mode_saved_key(){return"folders_view_mode_"+this.folder_type.toLowerCase()},view_mode(){return!0},search_placeholder(){return this.folder_type==="project"?this.$t("search_in_title_desc_kw"):this.folder_type==="publication"?this.$t("search_in_title"):this.$t("search_by_name")},order_options(){return[{key:"$date_created",text:this.$t("date_created")},{key:"$date_modified",text:this.$t("date_modified")},{key:"alphabetical",text:this.$t("alphabetical")}]},sorted_folders(){return this.folders?this.folders.slice().filter(s=>this.canLoggedinSeeFolder({folder:s})).sort((s,t)=>{if(this.folder_type==="project"){if(s.$status!=="finished"&&t.$status==="finished")return 1;if(s.$status==="finished"&&t.$status!=="finished")return-1}if(this.order_key==="$date_created")return+new Date(t.$date_created)-+new Date(s.$date_created);if(this.order_key==="$date_modified")return+new Date(t.$date_modified)-+new Date(s.$date_modified);if(this.order_key==="alphabetical"){const e=s.title||s.name||"",r=t.title||t.name||"";return e.localeCompare(r)}}):[]},active_filters(){var t;let s=[];return(t=this.$route.query)!=null&&t.pfilters&&JSON.parse(this.$route.query.pfilters).map(r=>{s.push({filter_type:r.filter_type,value:decodeURI(r.value)})}),s},opened_event(){return this.$route.hash.substring(1)||!1},filtered_folders(){return this.sorted_folders.filter(s=>{var t,e,r;if(this.search_query){if(this.folder_type==="project"){if(!this.searchInProject(s))return!1}else if(this.folder_type==="publication"){if(!this.twoStringsSearch(s.title,this.search_query))return!1}else if(!this.twoStringsSearch(s.name,this.search_query))return!1}if(this.current_view_mode==="map"&&(!s.$location||!s.$location.latitude))return!1;if(this.folder_type==="project"){for(const i of this.active_filters){const a=i.filter_type,n=i.value;if(a==="authors"){const l=this.getAuthor(n);if(!l||!((t=s.$contributors)!=null&&t.includes(l.$path))&&!((e=s.$admins)!=null&&e.includes(l.$path)))return!1}else if(!Object.prototype.hasOwnProperty.call(s,a))return!1;if(Array.isArray(s[a])&&!s[a].includes(n))return!1;if(typeof s[a]=="string"&&s[a]!==n)return!1}if(this.opened_event&&this.opened_event!==s.event_linked_slug)return!1}return!(this.folder_type==="author"&&this.filter_by_group&&!((r=s.group)!=null&&r.includes(this.filter_by_group)))})},project_admins_and_contributors(){if(this.folder_type!=="project")return[];const s=this.extractArr(this.filtered_folders,"$admins"),t=this.extractArr(this.filtered_folders,"$contributors");return[...s,...t].reduce((e,r)=>{const i=this.getAuthor(r);return i&&!e.some(a=>a.$path===i.$path)&&e.push(i),e},[]).sort((e,r)=>e.name.localeCompare(r.name))},all_groups(){return this.folder_type!=="author"?[]:this.sorted_folders.reduce((s,t)=>{var e;return(e=t.group)==null||e.map(r=>{s.some(i=>i===r)||r&&s.push(r)}),s},[]).sort((s,t)=>s.localeCompare(t))},map_pins(){const s="#142257";return this.filtered_folders.reduce((t,e)=>{if(e.$location){const{latitude:r,longitude:i}=e.$location;r&&i&&t.push({latitude:r,longitude:i,path:e.$path,label:e.title||e.name,color:s,pin_preview:"text"})}return t},[])},show_sidebar_toggle(){return this.folder_type==="author"?this.all_groups.length>0:this.folder_type==="publication"||this.folder_type==="space"?this.$slots.sidebar||!1:!0}},methods:{extractAll(s){return this.extractArr(this.filtered_folders,s)},toggleFilter({filter_type:s,value:t}){let e={};this.$route.query&&(e=JSON.parse(JSON.stringify(this.$route.query)));let r=e.pfilters?JSON.parse(e.pfilters):[];t&&!r.some(a=>a.filter_type===s&&a.value===encodeURI(t))?r.push({filter_type:s,value:encodeURI(t)}):r=r.filter(a=>!(a.filter_type===s&&a.value===encodeURI(t)));const i=this.$route.hash||!1;r.length>0?e.pfilters=JSON.stringify(r):delete e.pfilters,this.$router.push({query:e,hash:i})},resetFilters(){var e;let s={};const t=this.$route.hash||!1;(e=this.$route.query)!=null&&e.pfilters&&(s=JSON.parse(JSON.stringify(this.$route.query)),delete s.pfilters),this.$router.push({query:s,hash:t})},getActiveTags(s){return this.active_filters?this.active_filters.reduce((t,e)=>(e.filter_type===s&&t.push(e.value),t),[]):[]},toggleGroupFilter(s){this.filter_by_group=s===this.filter_by_group?"":s},searchInProject(s){if(s.title&&this.twoStringsSearch(s.title,this.search_query)||s.description&&this.twoStringsSearch(s.description,this.search_query))return!0;for(const t of["keywords","machines","materials"])if(s[t]&&s[t].some(e=>this.twoStringsSearch(e,this.search_query)))return!0;return!1},pinClicked(s){const t=this.createURLFromPath(s);this.$router.push(t)}}};var C=function(){var t=this,e=t._self._c;return e("FilterableListLayout",{staticClass:"_foldersListWithFilter",attrs:{has_sidebar:t.sorted_folders.length>0&&t.show_sidebar_toggle},scopedSlots:t._u([{key:"before-sidebar-toggle",fn:function(){return[t._t("before-sidebar-toggle")]},proxy:!0},t.sorted_folders.length>0?{key:"search",fn:function(){return[e("div",{staticClass:"_searchField"},[e("SearchInput",{attrs:{search_placeholder:t.search_placeholder,name:"search_folder"},model:{value:t.search_query,callback:function(r){t.search_query=r},expression:"search_query"}})],1)]},proxy:!0}:null,{key:"top-right",fn:function(){return[e("div",{staticClass:"_topRightControls"},[t.sorted_folders.length>0?[e("select",{directives:[{name:"model",rawName:"v-model",value:t.order_key,expression:"order_key"}],staticClass:"_orderSelect",attrs:{size:"small",name:"order_folders",disabled:t.filtered_folders.length<=1},on:{change:function(r){var i=Array.prototype.filter.call(r.target.options,function(a){return a.selected}).map(function(a){var n="_value"in a?a._value:a.value;return n});t.order_key=r.target.multiple?i:i[0]}}},t._l(t.order_options,function(r){return e("option",{key:r.key,domProps:{value:r.key,textContent:t._s(r.text)}})}),0)]:t._e(),t.view_mode?e("div",{staticClass:"_mode"},[t.available_view_modes.includes("list")?e("button",{staticClass:"u-button u-button_icon",class:{"is--active":t.current_view_mode==="list"},attrs:{type:"button"},on:{click:function(r){t.current_view_mode="list"}}},[e("b-icon",{attrs:{icon:"list-ol"}})],1):t._e(),t.available_view_modes.includes("tiny")?e("button",{staticClass:"u-button u-button_icon",class:{"is--active":t.current_view_mode==="tiny"},attrs:{type:"button"},on:{click:function(r){t.current_view_mode="tiny"}}},[e("b-icon",{attrs:{icon:"grid-3x2-gap-fill"}})],1):t._e(),t.available_view_modes.includes("medium")?e("button",{staticClass:"u-button u-button_icon",class:{"is--active":t.current_view_mode==="medium"},attrs:{type:"button"},on:{click:function(r){t.current_view_mode="medium"}}},[e("b-icon",{attrs:{icon:"grid-fill"}})],1):t._e(),t.available_view_modes.includes("map")?e("button",{staticClass:"u-button u-button_icon",class:{"is--active":t.current_view_mode==="map"},attrs:{type:"button",disabled:t.map_pins.length===0},on:{click:function(r){t.current_view_mode="map"}}},[e("b-icon",{attrs:{icon:"map-fill"}})],1):t._e()]):t._e(),t._t("top-right")],2)]},proxy:!0},{key:"sidebar",fn:function(){return[t.folder_type==="project"?[e("div",[e("DLabel",{attrs:{str:t.$t("status")}}),e("div",{staticClass:"_statusList"},t._l(t.extractAll("$status"),function(r){return e("StatusTag",{key:r,attrs:{status:r,can_edit:!1,mode:t.getActiveTags("$status").includes(r)?"disable":"active"},on:{click:function(i){return t.toggleFilter({filter_type:"$status",value:r})}}})}),1)],1),e("div",[e("DLabel",{attrs:{str:t.$t("contributors")}}),e("TagsList",{attrs:{tags:t.project_admins_and_contributors,tag_type:"authors",tags_active:t.getActiveTags("authors")},on:{tagClick:function(r){return t.toggleFilter({filter_type:"authors",value:r})}}})],1),t._l(["target_audience","disciplines","level","keywords","machines","materials"],function(r){return[t.extractAll(r).length>0?e("div",{key:r},[r==="level"?[e("DLabel",{attrs:{str:t.$t("levels_and_competences")}}),e("TagsList",{attrs:{tags:t.extractAll("level"),tag_type:"level",tags_active:t.getActiveTags("level")},on:{tagClick:function(i){return t.toggleFilter({filter_type:"level",value:i})}}})]:[e("DLabel",{attrs:{str:t.$t(r)}}),e("TagsList",{attrs:{tags:t.extractAll(r),tag_type:r,tags_active:t.getActiveTags(r)},on:{tagClick:function(i){return t.toggleFilter({filter_type:r,value:i})}}})]],2):t._e()]})]:t._e(),t.folder_type==="author"?[t.all_groups.length>0?e("div",[e("DLabel",{attrs:{str:t.$t("group")}}),e("TagsList",{attrs:{tags:t.all_groups,tag_type:"accountgroup",tags_active:[t.filter_by_group]},on:{tagClick:function(r){return t.toggleGroupFilter(r)}}})],1):t._e()]:t._e(),t._t("sidebar")]},proxy:!0},{key:"active-filters",fn:function(){return[e("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[t.active_filters.length>0?e("transition-group",{staticClass:"_tagList",attrs:{tag:"section",name:"listComplete",appear:""}},[t._l(t.active_filters,function(r){return[r.filter_type==="$status"?e("StatusTag",{key:"status_"+r.value,attrs:{status:r.value,can_edit:!1,mode:"disable"},on:{click:function(i){return t.toggleFilter({filter_type:"$status",value:r.value})}}}):r.filter_type==="authors"?e("AuthorTag",{key:"authors_"+r.value,attrs:{path:r.value,mode:"disable"},on:{click:function(i){return t.toggleFilter({filter_type:"authors",value:r.value})}}}):e("SingleTag",{key:r.filter_type+"_"+r.value,attrs:{tag_type:r.filter_type,tag_str:r.value,mode:"disable"},on:{tagClick:function(i){return t.toggleFilter({filter_type:r.filter_type,value:r.value})}}})]}),t.active_filters.length>1?e("button",{key:"reset_all",staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.resetFilters}},[t._v(" "+t._s(t.$t("reset_all"))+" ")]):t._e()],2):t._e()],1)]},proxy:!0},{key:"list",fn:function(){return[t._t("list-header"),t.current_view_mode==="list"||t.current_view_mode==="medium"||t.current_view_mode==="tiny"?[e("FoldersList",{attrs:{folders:t.filtered_folders,pinned_folders:t.pinned_folders,path:t.path,can_edit:t.can_edit,pin_field_name:t.pin_field_name,pin_label:t.pin_label,empty_message:t.empty_message,view_mode:t.current_view_mode},scopedSlots:t._u([{key:"default",fn:function(r){return[t._t("item",null,{item:r.item,view_mode:t.current_view_mode})]}}],null,!0)})]:t.current_view_mode==="map"?[e("div",{staticClass:"_mapContainer"},[e("DisplayOnMap",{attrs:{pins:t.map_pins,map_baselayer_opacity:.5,map_baselayer_bw:!0,is_small:!1},on:{"update:opened_pin_path":function(r){return t.pinClicked(r)}}})],1)]:t._e()]},proxy:!0}],null,!0)})},S=[],L=o(k,C,S,!1,null,"b03d2d57");const F=L.exports,x={props:{},mixins:[d],components:{AuthorCard:u,FoldersListWithFilter:F},data(){return{path:"authors",authors:[]}},created(){},async mounted(){this.updateDocumentTitle(this.$t("list_of_accounts")),this.$api.updateSelfPath(this.path),this.authors=await this.$api.getFolders({path:this.path}),this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{filtered_authors_count(){return this.$refs.foldersList&&this.$refs.foldersList.filtered_folders?this.$refs.foldersList.filtered_folders.length:this.authors.length}},methods:{}};var A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_authorsView"},[e("h1",{staticClass:"_title",domProps:{textContent:t._s(t.$t("list_of_accounts"))}}),e("FoldersListWithFilter",{ref:"foldersList",attrs:{folders:t.authors,folder_type:"author",path:t.path,can_edit:!1,empty_message:t.$t("no_accounts_to_show"),available_view_modes:["list","medium","map"]},scopedSlots:t._u([{key:"list-header",fn:function(){return[e("div",{staticClass:"u-spacingBottom"},[t._v(" "+t._s(t.$t("accounts_displayed",{count:t.filtered_authors_count,total:t.authors.length}))+" ")]),t.$api.other_devices_connected.length>=1?e("div",{staticClass:"_currentlyConnected"},[e("DetailsPane",{attrs:{header:t.$t("other_devices_connected"),icon:"people",has_items:t.$api.other_devices_connected.length}},t._l(t.$api.other_devices_connected,function(r,i){return e("div",{key:r.id,staticClass:"u-spacingBottom"},[i!==0?e("hr"):t._e(),e("div",[r.meta.token_path?e("AuthorTag",{attrs:{path:r.meta.token_path}}):e("span",[t._v(t._s(t.$t("not_logged_in")))])],1),e("DLabel",{attrs:{str:t.$t("opened_page")}}),r.meta.path?e("router-link",{staticClass:"u-buttonLink",attrs:{to:{path:t.createURLFromPath(r.meta.path)}}},[t._v(" "+t._s(t.$t("open"))+" ")]):t._e()],1)}),0)],1):t._e()]},proxy:!0},{key:"item",fn:function({item:r}){return[e("div",{staticClass:"_authorItem"},[e("AuthorCard",{attrs:{author:r}})],1)]}}])})],1)},q=[],D=o(x,A,q,!1,null,"78ca6a7e");const O=D.exports;export{O as default};
