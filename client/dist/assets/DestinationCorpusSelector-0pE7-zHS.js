import{n,_ as o}from"../build.js";const a={props:{file:Object,context:String,position:String,can_edit:Boolean,show_infos_on_mounted:Boolean},components:{CropAdjustMedia:()=>o(()=>import("./CropAdjustMedia-DWEh4p3H.js"),[]),OptimizeMedia:()=>o(()=>import("./OptimizeMedia-D6rIJRsb.js"),[])},data(){return{show_infos:this.show_infos_on_mounted,is_dragged:!1,edit_mode:!1,is_regenerating:!1,show_cropadjust_modal:!1}},i18n:{messages:{fr:{description_of_media:"Description du média",origin_of_media:"Provenance du média"},en:{description_of_media:"Media description",origin_of_media:"Media origin"}}},created(){localStorage.getItem("show_infos")&&!this.show_infos_on_mounted?this.show_infos=localStorage.getItem("show_infos")!=="false":this.show_infos=this.can_edit||this.has_caption||this.has_credits||this.has_bibliography},mounted(){this.$eventHub.$on("fileshown.showInfos",this.showInfos),this.$eventHub.$on("fileshown.hideInfos",this.hideInfos)},beforeDestroy(){this.$eventHub.$off("fileshown.showInfos",this.showInfos),this.$eventHub.$off("fileshown.hideInfos",this.hideInfos)},watch:{show_infos(){localStorage.setItem("show_infos",this.show_infos)}},computed:{has_caption(){var i;return this.hasText((i=this.file)==null?void 0:i.caption)},has_credits(){var i;return this.hasText((i=this.file)==null?void 0:i.$credits)},has_bibliography(){var i;return this.hasText((i=this.file)==null?void 0:i.bibliography)},optimization_possible(){return this.fileCanBeOptimized({path:this.file.$media_filename})},optimization_strongly_recommended(){return this.fileShouldBeOptimized({path:this.file.$media_filename})},cropadjust_possible(){return this.file.$type==="image"&&!this.file.$media_filename.endsWith(".gif")}},methods:{hasText(i){return i==null?!1:String(i).trim().length>0},async regenerateThumbs(){this.is_regenerating=!0,await this.$api.regenerateThumbs({path:this.file.$path}),this.is_regenerating=!1},showInfos(){this.show_infos=!0},hideInfos(){this.show_infos=!1}}};var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_fileShown"},[e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[t.file?e("div",{key:t.file.$path,staticClass:"_single",attrs:{"data-type":t.file.$type}},[t.file.$type==="text"?e("div",{staticClass:"_textEditor2"},[e("CollaborativeEditor3",{attrs:{path:t.file.$path,content:t.file.$content,custom_formats:["bold","italic","underline","link"],can_edit:t.can_edit,mode:t.context==="chutier"?"edit_on_mounted":"normal"}})],1):e("MediaContent",{attrs:{file:t.file,context:"full",resolution:1600,show_fs_button:!0,zoom_on_click:!1}}),t.position?e("div",{staticClass:"_navArrow"},[e("button",{staticClass:"u-button u-button_icon u-button_transparent",attrs:{type:"button",disabled:t.position==="alone"||t.position==="first"},on:{click:function(s){return t.$eventHub.$emit("carousel.prev")}}},[e("b-icon",{attrs:{icon:"arrow-left-short"}})],1),e("button",{staticClass:"u-button u-button_icon u-button_transparent",attrs:{type:"button",disabled:t.position==="alone"||t.position==="last"},on:{click:function(s){return t.$eventHub.$emit("carousel.next")}}},[e("b-icon",{attrs:{icon:"arrow-right-short"}})],1),t.cropadjust_possible?e("button",{staticClass:"u-button u-button_icon u-button_small u-button_glass _cropAdjustBtn",attrs:{type:"button"},on:{click:function(s){t.show_cropadjust_modal=!0}}},[e("b-icon",{attrs:{icon:"bounding-box"}})],1):t._e()]):t._e(),t.file.$thumbs==="no_preview"?e("button",{staticClass:"u-buttonLink _regenerateBtn",attrs:{type:"button"},on:{click:t.regenerateThumbs}},[t.is_regenerating?e("LoaderSpinner"):[e("b-icon",{attrs:{icon:"arrow-clockwise"}}),t._v(" "+t._s(t.$t("regenerate_thumbs"))+" ")]],2):t._e(),e("div",{staticClass:"_dragEditBtn"},[e("DragFile",{attrs:{file:t.file,is_dragged:t.is_dragged},on:{"update:is_dragged":function(s){t.is_dragged=s}}})],1)],1):t._e()]),e("div",{staticClass:"_unfoldBtn"},[e("button",{staticClass:"u-button u-button_icon u-button_transparent",attrs:{type:"button"},on:{click:function(s){t.show_infos=!t.show_infos}}},[t.show_infos?e("b-icon",{attrs:{icon:"chevron-down","aria-label":t.$t("close")}}):e("b-icon",{attrs:{icon:"chevron-up","aria-label":t.$t("open")}})],1)]),t.show_cropadjust_modal?e("CropAdjustMedia",{attrs:{media:t.file,available_save_actions:["replaceOriginal","download"]},on:{close:function(s){t.show_cropadjust_modal=!1},closeParentModal:function(s){t.show_cropadjust_modal=!1}}}):t._e(),e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[t.show_infos?e("div",{key:t.file.$path,staticClass:"_infos"},[e("div",{staticClass:"_infos--content"},[e("div",{staticClass:"_captionCreditContainer"},[e("div",{staticClass:"_captionCreditItem"},[e("h4",{domProps:{textContent:t._s(t.$t("description_of_media"))}}),t.file.$type==="url"?e("div",{staticClass:"u-spacingBottom"},[e("div",{staticClass:"_labelLine"},[e("b-icon",{attrs:{icon:"link-45deg","aria-label":t.$t("link")}}),e("DLabel",{attrs:{str:t.$t("link")}})],1),e("div",{staticClass:"u-filename"},[e("a",{attrs:{href:t.file.$content,target:"_blank",rel:"noopener noreferrer"}},[t._v(" "+t._s(t.file.$content)+" ")])])]):t._e(),e("div",{staticClass:"u-spacingBottom"},[e("TextEditor",{attrs:{label:t.$t("caption"),icon:"text-left",field_to_edit:"caption",content:t.file.caption,path:t.file.$path,placeholder:"",custom_formats:["bold","italic","link"],maxlength:1280,can_edit:t.can_edit}})],1)]),e("div",{staticClass:"_captionCreditItem"},[e("DLabel",{attrs:{str:t.$t("origin_of_media"),tag:"h4",instructions:t.$t("origin_of_media_instructions")}}),e("div",{staticClass:"u-spacingBottom"}),e("div",{staticClass:"u-spacingBottom"},[e("TextEditor",{attrs:{label:t.$t("credit"),icon:"c-circle",field_to_edit:"$credits",content:t.file.$credits,path:t.file.$path,placeholder:"",custom_formats:["bold","italic","link"],maxlength:1280,can_edit:t.can_edit}})],1),e("div",{staticClass:"u-spacingBottom"},[e("TextEditor",{attrs:{label:t.$t("bibliography"),icon:"bookmark",field_to_edit:"bibliography",content:t.file.bibliography,path:t.file.$path,placeholder:"",custom_formats:["bold","italic","link"],maxlength:1280,can_edit:t.can_edit}})],1)],1)]),t.optimization_strongly_recommended||t.optimization_possible?e("OptimizeMedia",{attrs:{media:t.file},on:{close:function(s){return t.$emit("close")}}}):t._e(),(t.file.$location,t._e())],2)]):t._e()])],1)},l=[],_=n(a,r,l,!1,null,"99354c13");const p=_.exports,c={props:{selected_destination_folder_path:String},data(){return{folders:[],fetch_spaces_error:null}},watch:{},async created(){await this.listDestinationFolders()},methods:{getFilename(i){return i.split("/").pop()},async listDestinationFolders(){const i=await this.$api.getFolders({path:"folders"}).catch(t=>{this.fetch_spaces_error=t.response});(i==null?void 0:i.length)>0?(this.folders=i.filter(t=>this.canLoggedinContributeToFolder({folder:t})),this.selected_destination_folder_path||(localStorage.getItem("last_opened_folder_slug")?this.$emit("update:selected_destination_folder_path","folders/"+localStorage.getItem("last_opened_folder_slug")):this.$emit("update:selected_destination_folder_path",i[0].$path))):this.folders=[]}}};var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_destinationCorpusSelector"},[e("select",{key:t.folders.length,staticClass:"u-select",domProps:{value:t.selected_destination_folder_path},on:{change:function(s){return t.$emit("update:selected_destination_folder_path",s.target.value)}}},t._l(t.folders,function(s){return e("option",{key:s.$path,domProps:{value:s.$path}},[t._v(" "+t._s(s.title||t.getFilename(s.$path))+" ")])}),0)])},h=[],f=n(c,d,h,!1,null,"7bd42ddd");const m=f.exports;export{m as D,p as F};
